<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raffle Number Game - Complete Prototype</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        /* ===== SCREEN CONTAINERS ===== */
        .screen {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .hidden {
            display: none !important;
        }

        /* ===== LOGIN SCREEN ===== */
        .login-form {
            padding: 40px;
            text-align: center;
        }

        .logo {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        .logo i {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .logo h1 {
            font-size: 32px;
        }

        .input-group {
            display: flex;
            align-items: center;
            background: #f5f5f5;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .input-group i {
            color: #667eea;
            margin-right: 10px;
            font-size: 20px;
        }

        .input-group input {
            border: none;
            background: transparent;
            font-size: 16px;
            width: 100%;
            outline: none;
        }

        /* ===== BUTTONS ===== */
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: transform 0.2s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            margin: 5px 0;
        }

        .btn-success {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            transition: all 0.3s;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-success:active {
            background: #1e7e34;
            transform: translateY(0);
        }

        .btn-success.placed {
            background: #dc3545;
            animation: pulse 0.5s;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-icon {
            background: none;
            border: none;
            font-size: 16px;
            color: white;
            cursor: pointer;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* ===== DEMO USERS ===== */
        .demo-users {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .user-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 10px 0;
        }

        .user-badges span {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-badges span:hover {
            background: #764ba2;
            transform: scale(1.05);
        }

        /* ===== HEADER ===== */
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h2 {
            font-size: 18px;
            text-align: center;
            flex: 1;
        }

        .balance {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }

        /* ===== TABS ===== */
        .tabs {
            display: flex;
            background: #f8f9fa;
            padding: 10px;
        }

        .tab {
            flex: 1;
            padding: 15px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .tab.active {
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            padding: 20px;
            display: none;
            min-height: 400px;
        }

        .tab-content.active {
            display: block;
        }

        /* ===== RAFFLE ITEMS ===== */
        .items-grid {
            display: grid;
            gap: 15px;
        }

        .item-card {
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .item-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .item-card h4 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .item-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 10px;
            margin: 10px 0;
        }

        .item-info {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        /* ===== WALLET ===== */
        .wallet-info {
            text-align: center;
        }

        .balance-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .balance-card .amount {
            font-size: 40px;
            font-weight: bold;
            margin: 10px 0;
            letter-spacing: 1px;
        }

        .deposits {
            margin: 20px 0;
        }

        .deposit-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #28a745;
        }

        .deposit-item.expiring {
            border-left-color: #ffc107;
            background: #fff3cd;
        }

        .deposit-item.expired {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        /* ===== MODALS ===== */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            padding: 30px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 30px;
            cursor: pointer;
            color: #666;
        }

        /* ===== CALCULATOR ===== */
        .calculator {
            display: grid;
            gap: 10px;
            margin: 20px 0;
        }

        .calc-row {
            display: flex;
            gap: 10px;
        }

        .calc-btn {
            flex: 1;
            padding: 20px;
            font-size: 24px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .calc-btn:hover {
            background: #f8f9fa;
            border-color: #667eea;
        }

        .number-display {
            text-align: center;
            margin: 20px 0;
        }

        #bet-number {
            font-size: 36px;
            text-align: center;
            border: 3px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            width: 100%;
            background: #f8f9fa;
            font-weight: bold;
            letter-spacing: 2px;
            font-family: monospace;
        }

        /* ===== QUICK BETS ===== */
        .quick-bet {
            margin: 20px 0;
        }

        .quick-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .quick-btn {
            flex: 1;
            padding: 15px;
            background: #e9ecef;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .quick-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* ===== CASH IN OPTIONS ===== */
        .cashin-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .cashin-option {
            padding: 25px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .cashin-option:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: scale(1.05);
        }

        /* ===== ADMIN STYLES ===== */
        .admin-content {
            padding: 20px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }

        .stat-card div {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
            margin-top: 5px;
        }

        /* ===== BET LIST ===== */
        .bet-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #667eea;
        }

        .bet-item.won {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .bet-item.refunded {
            border-left-color: #6c757d;
            background: #e9ecef;
        }

        /* ===== NOTIFICATIONS ===== */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1001;
            animation: slideInRight 0.3s ease;
        }

        .notification.warning {
            background: #ffc107;
            color: #212529;
        }

        .notification.error {
            background: #dc3545;
        }

        .notification.info {
            background: #17a2b8;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .login-form {
                padding: 20px;
            }
            
            .logo {
                padding: 30px 20px;
            }
            
            .tab {
                font-size: 12px;
                padding: 10px 5px;
            }
            
            .admin-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            #bet-number {
                font-size: 28px;
                padding: 12px;
            }
            
            .balance-card .amount {
                font-size: 32px;
            }
        }
        
        /* ===== DECIMAL FORMATTING ===== */
        .decimal-format {
            font-family: monospace;
            letter-spacing: 1px;
        }
        
        /* ===== FORM LABELS ===== */
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #667eea;
            font-size: 14px;
        }
        
        .datetime-input {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            width: 100%;
            font-size: 14px;
        }
        
        /* ===== SERVICE FEE DISPLAY ===== */
        .service-fee {
            color: #dc3545;
            font-size: 12px;
            margin-top: 5px;
        }
        
        /* ===== TRANSFER BUTTONS ===== */
        .transfer-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .transfer-btn {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
        }
        
        .shopee-btn {
            background: #ee4d2d;
            color: white;
        }
        
        .lazada-btn {
            background: #0d1464;
            color: white;
        }
        
        /* ===== COUNTDOWN TIMER ===== */
        .countdown {
            font-size: 12px;
            color: #666;
            background: #f8f9fa;
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
            margin-top: 5px;
        }
        
        /* ===== RANDOM BET SECTION ===== */
        .random-bet-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .random-controls {
            display: grid;
            gap: 10px;
            margin-top: 10px;
        }
        
        .random-btn {
            background: #6f42c1;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .random-btn:hover {
            background: #5a32a3;
        }
        
        .random-numbers-display {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin-top: 10px;
            max-height: 100px;
            overflow-y: auto;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .random-number-badge {
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-family: monospace;
        }
        
        .bet-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .bet-control-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #dee2e6;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .bet-control-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .use-max-btn {
            background: #20c997;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            width: 100%;
        }
        
        .use-max-btn:hover {
            background: #1aa179;
        }
        
        /* ===== BET SUMMARY ===== */
        .bet-summary {
            background: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .bet-summary-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        /* ===== AUTO BET SECTION ===== */
        .auto-bet-section {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #ffc107;
        }
        
        .auto-bet-controls {
            display: grid;
            gap: 10px;
            margin-top: 10px;
        }
        
        .auto-bet-btn {
            background: #fd7e14;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .auto-bet-btn:hover {
            background: #e96b00;
        }
        
        .auto-bet-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .auto-bet-status {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        
        /* ===== PLACE GAME BUTTON ===== */
        .place-game-btn-container {
            margin: 30px 0;
        }
        
        .place-game-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 20px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            animation: pulse-btn 2s infinite;
        }
        
        @keyframes pulse-btn {
            0% { transform: scale(1); box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 8px 20px rgba(40, 167, 69, 0.6); }
            100% { transform: scale(1); box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4); }
        }
        
        .place-game-btn:hover {
            background: #218838;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.6);
        }
        
        .place-game-btn:active {
            transform: translateY(0);
        }
        
        .place-game-btn.placed {
            background: #dc3545;
            animation: none;
            transform: scale(0.98);
        }
        
        .place-game-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            animation: none;
            transform: none;
        }
        
        .place-game-btn.placed:hover {
            background: #c82333;
        }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="screen">
        <div class="logo">
            <i class="fas fa-ticket-alt"></i>
            <h1>Raffle Number Game</h1>
            <p>Prototype v1.0</p>
        </div>
        
        <div class="login-form">
            <h2>Login to Play</h2>
            <p style="color: #666; margin-bottom: 20px;">Demo: Use username 1-5 with same password</p>
            
            <div class="input-group">
                <i class="fas fa-user"></i>
                <input type="text" id="username" placeholder="Enter username (1-5)" maxlength="20">
            </div>
            
            <div class="input-group">
                <i class="fas fa-lock"></i>
                <input type="password" id="password" placeholder="Enter password" value="1">
            </div>
            
            <button onclick="login()" class="btn-primary">
                <i class="fas fa-sign-in-alt"></i> Login to Game
            </button>
            
            <div class="demo-users">
                <h3>Quick Login (Click Any):</h3>
                <div class="user-badges">
                    <span onclick="fillLogin('1', '1')">User 1 (‚Ç±50.000)</span>
                    <span onclick="fillLogin('2', '2')">User 2 (‚Ç±50.000)</span>
                    <span onclick="fillLogin('3', '3')">User 3 (‚Ç±50.000)</span>
                    <span onclick="fillLogin('4', '4')">User 4 (‚Ç±50.000)</span>
                    <span onclick="fillLogin('5', '5')">User 5 (‚Ç±50.000)</span>
                </div>
                <p><small>All start with ‚Ç±50.000 play money</small></p>
            </div>
            
            <div class="admin-login" style="margin-top: 30px;">
                <button onclick="adminLogin()" class="btn-secondary">
                    <i class="fas fa-cog"></i> Admin Login (Username: admin, Password: secret)
                </button>
            </div>
        </div>
    </div>

    <!-- USER DASHBOARD -->
    <div id="user-dashboard" class="screen hidden">
        <header>
            <button onclick="logout()" class="btn-icon" title="Logout">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <h2>Welcome, <span id="current-user" style="color: #ffeb3b;">User</span></h2>
            <div class="balance">
                <i class="fas fa-wallet"></i>
                ‚Ç±<span id="user-balance" class="decimal-format">50.000</span>
            </div>
        </header>
        
        <nav class="tabs">
            <button class="tab active" onclick="showTab('play')">
                <i class="fas fa-gamepad"></i> Play
            </button>
            <button class="tab" onclick="showTab('wallet')">
                <i class="fas fa-wallet"></i> Wallet
            </button>
            <button class="tab" onclick="showTab('bets')">
                <i class="fas fa-history"></i> My Bets
            </button>
            <button class="tab" onclick="showTab('send')">
                <i class="fas fa-paper-plane"></i> Send
            </button>
        </nav>
        
        <!-- PLAY TAB -->
        <div id="play-tab" class="tab-content active">
            <h3 style="margin-bottom: 20px; color: #667eea;">üéØ Active Raffles</h3>
            <div id="raffle-items" class="items-grid">
                <!-- Items loaded by JavaScript -->
            </div>
            <p style="text-align: center; color: #666; margin-top: 20px; font-size: 14px;">
                Tap any item to place your bet
            </p>
        </div>
        
        <!-- WALLET TAB -->
        <div id="wallet-tab" class="tab-content">
            <div class="wallet-info">
                <h3 style="color: #667eea; margin-bottom: 20px;">üí∞ My Wallet</h3>
                
                <div class="balance-card">
                    <h4>Available Play Money</h4>
                    <div class="amount decimal-format" id="wallet-balance">‚Ç±50.000</div>
                    <p>Use for betting only</p>
                </div>
                
                <div class="deposits">
                    <h4 style="margin: 20px 0 10px 0;">üìÖ Active Deposits</h4>
                    <div id="deposits-list">
                        <!-- Deposits loaded here -->
                    </div>
                    <p style="color: #666; font-size: 12px; margin-top: 10px;">
                        ‚è∞ Deposits expire in 5 days. You'll be notified before expiry.
                    </p>
                </div>
                
                <button onclick="showCashIn()" class="btn-primary" style="margin-top: 30px;">
                    <i class="fas fa-plus-circle"></i> Cash In More Money
                </button>
                
                <div style="margin-top: 20px; padding: 15px; background: #f0f8ff; border-radius: 10px;">
                    <h4 style="color: #667eea;">üè¶ Wallet Info</h4>
                    <p style="margin: 10px 0;">Shopee Wallet: <strong id="shopee-wallet">Not set</strong></p>
                    <p>Lazada Wallet: <strong id="lazada-wallet">Not set</strong></p>
                    <button onclick="showWalletSetup()" class="btn-secondary" style="margin-top: 10px;">
                        Setup Wallets
                    </button>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="color: #667eea;">‚ÑπÔ∏è Service Information</h4>
                    <p style="margin: 5px 0; font-size: 14px;">‚Ä¢ $2.00 service fee for wallet transfers</p>
                    <p style="margin: 5px 0; font-size: 14px;">‚Ä¢ 2% service fee on refunded bets</p>
                    <p style="margin: 5px 0; font-size: 14px;">‚Ä¢ Deposits expire in 5 days</p>
                </div>
            </div>
        </div>
        
        <!-- MY BETS TAB -->
        <div id="bets-tab" class="tab-content">
            <h3 style="color: #667eea; margin-bottom: 20px;">üìä My Betting History</h3>
            <div id="bets-list">
                <!-- Bets loaded here -->
                <p style="text-align: center; color: #999; padding: 40px;">
                    No bets placed yet. Start playing!
                </p>
            </div>
        </div>
        
        <!-- SEND MONEY TAB -->
        <div id="send-tab" class="tab-content">
            <h3 style="color: #667eea; margin-bottom: 20px;">üí∏ Send Play Money</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Recipient Username:</label>
                    <input type="text" id="recipient" placeholder="Enter username" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Amount to Send:</label>
                    <input type="number" id="send-amount" placeholder="‚Ç± Amount" min="0.001" step="0.001" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                </div>
                
                <div style="background: #fff3cd; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                    <p style="margin: 0; font-size: 14px; color: #856404;">
                        <i class="fas fa-info-circle"></i> No service fee for peer-to-peer transfers
                    </p>
                </div>
                
                <button onclick="sendMoney()" class="btn-primary">
                    <i class="fas fa-paper-plane"></i> Send Now
                </button>
                
                <p style="margin-top: 20px; color: #666; font-size: 14px;">
                    üí° You can only send to existing users. Money will be deducted from your balance.
                </p>
            </div>
        </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="admin-dashboard" class="screen hidden">
        <header>
            <button onclick="logout()" class="btn-icon" title="Logout">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <h2><i class="fas fa-cog"></i> Admin Control Panel</h2>
        </header>
        
        <div class="admin-content">
            <div class="admin-stats">
                <div class="stat-card">
                    <h4>Total Users</h4>
                    <div id="total-users">5</div>
                </div>
                <div class="stat-card">
                    <h4>Total Balance</h4>
                    <div id="total-balance" class="decimal-format">‚Ç±250.000</div>
                </div>
                <div class="stat-card">
                    <h4>Active Raffles</h4>
                    <div id="active-raffles">3</div>
                </div>
                <div class="stat-card">
                    <h4>Total Bets</h4>
                    <div id="total-bets">0</div>
                </div>
                <div class="stat-card">
                    <h4>Winners</h4>
                    <div id="total-winners">0</div>
                </div>
                <div class="stat-card">
                    <h4>Service Fees</h4>
                    <div id="total-fees" class="decimal-format">‚Ç±0.000</div>
                </div>
            </div>
            
            <div class="admin-actions" style="margin-top: 30px;">
                <button onclick="showAddItem()" class="btn-primary" style="margin-bottom: 20px;">
                    <i class="fas fa-plus-circle"></i> Add New Raffle Item
                </button>
                
                <h3 style="color: #667eea; margin: 20px 0;">üë• All Users</h3>
                <div id="users-list" style="max-height: 200px; overflow-y: auto;">
                    <!-- Users loaded here -->
                </div>
                
                <h3 style="color: #667eea; margin: 20px 0;">üéÅ Raffle Items</h3>
                <div id="admin-items-list" style="max-height: 300px; overflow-y: auto;">
                    <!-- Items loaded here -->
                </div>
                
                <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="color: #667eea;">‚öôÔ∏è Admin Tools</h4>
                    <button onclick="runRaffle()" class="btn-secondary" style="margin: 10px 5px;">
                        Run Raffle Draw
                    </button>
                    <button onclick="checkExpirations()" class="btn-secondary" style="margin: 10px 5px;">
                        Check Expirations
                    </button>
                    <button onclick="resetAllData()" class="btn-secondary" style="margin: 10px 5px;">
                        Reset Demo Data
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- GAME MODAL -->
    <div id="game-modal" class="modal hidden">
        <div class="modal-content">
            <button onclick="closeModal()" class="close-btn">&times;</button>
            <h3 id="item-name" style="color: #667eea; text-align: center;">Loading...</h3>
            <img id="item-image" src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=200&fit=crop" alt="Item" style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px; margin: 15px 0;">
            
            <div class="betting-interface">
                <div class="number-display">
                    <input type="text" id="bet-number" value="0.000" readonly style="font-size: 36px; padding: 15px;" class="decimal-format">
                </div>
                
                <p style="text-align: center; color: #666; margin: 10px 0;">
                    Enter your unique number (format: X.XXX where X=0-9)
                </p>
                
                <div class="calculator">
                    <div class="calc-row">
                        <button class="calc-btn" onclick="addNumber('1')">1</button>
                        <button class="calc-btn" onclick="addNumber('2')">2</button>
                        <button class="calc-btn" onclick="addNumber('3')">3</button>
                    </div>
                    <div class="calc-row">
                        <button class="calc-btn" onclick="addNumber('4')">4</button>
                        <button class="calc-btn" onclick="addNumber('5')">5</button>
                        <button class="calc-btn" onclick="addNumber('6')">6</button>
                    </div>
                    <div class="calc-row">
                        <button class="calc-btn" onclick="addNumber('7')">7</button>
                        <button class="calc-btn" onclick="addNumber('8')">8</button>
                        <button class="calc-btn" onclick="addNumber('9')">9</button>
                    </div>
                    <div class="calc-row">
                        <button class="calc-btn" onclick="addNumber('.')">.</button>
                        <button class="calc-btn" onclick="addNumber('0')">0</button>
                        <button class="calc-btn" onclick="clearNumber()">C</button>
                    </div>
                </div>
                
                <div class="quick-bet">
                    <h4 style="margin: 20px 0 10px 0;">üí∏ Quick Bet Amounts</h4>
                    <div class="quick-buttons">
                        <button class="quick-btn" onclick="setBetAmount(50)">‚Ç±50.000</button>
                        <button class="quick-btn" onclick="setBetAmount(100)">‚Ç±100.000</button>
                        <button class="quick-btn" onclick="setBetAmount(150)">‚Ç±150.000</button>
                        <button class="quick-btn" onclick="setBetAmount(200)">‚Ç±200.000</button>
                        <button class="quick-btn" onclick="setBetAmount(250)">‚Ç±250.000</button>
                        <button class="quick-btn" onclick="setBetAmount(500)">‚Ç±500.000</button>
                    </div>
                </div>
                
                <div class="bet-amount" style="margin: 20px 0;">
                    <h4>Bet Amount: ‚Ç±<span id="current-bet-amount" class="decimal-format">50.000</span></h4>
                    <input type="range" id="bet-slider" min="1" max="1000" value="50" step="1" style="width: 100%; margin: 10px 0;">
                </div>
                
                <div style="background: #e9ecef; padding: 15px; border-radius: 10px; margin: 20px 0;">
                    <p style="margin: 5px 0;">Your Balance: <strong class="decimal-format">‚Ç±<span id="modal-balance">50.000</span></strong></p>
                    <p style="margin: 5px 0;">After Bet: <strong class="decimal-format">‚Ç±<span id="after-bet">0.000</span></strong></p>
                    <p style="margin: 5px 0; font-size: 12px; color: #dc3545;" id="fee-warning"></p>
                </div>
                
                <!-- RANDOM BET SECTION -->
                <div class="random-bet-section">
                    <h4 style="color: #667eea; margin-bottom: 10px;"><i class="fas fa-random"></i> Random Bet Options</h4>
                    
                    <div class="random-controls">
                        <button class="random-btn" onclick="generateRandomNumber()">
                            <i class="fas fa-dice"></i> Generate Random Number
                        </button>
                        
                        <div class="bet-controls">
                            <button class="bet-control-btn active" onclick="setRandomCount(1)">
                                1 Number
                            </button>
                            <button class="bet-control-btn" onclick="setRandomCount(5)">
                                5 Numbers
                            </button>
                            <button class="bet-control-btn" onclick="setRandomCount(10)">
                                10 Numbers
                            </button>
                        </div>
                        
                        <div id="random-numbers-display" class="random-numbers-display">
                            <!-- Random numbers will appear here -->
                        </div>
                        
                        <button class="use-max-btn" onclick="useMaxBalance()">
                            <i class="fas fa-money-bill-wave"></i> Use All Balance for Random Bets
                        </button>
                    </div>
                </div>
                
                <!-- AUTO BET SECTION -->
                <div class="auto-bet-section">
                    <h4 style="color: #856404; margin-bottom: 10px;"><i class="fas fa-bolt"></i> Auto Bet</h4>
                    
                    <div class="auto-bet-controls">
                        <button class="auto-bet-btn" id="auto-bet-btn" onclick="toggleAutoBet()">
                            <i class="fas fa-play"></i> Start Auto Betting
                        </button>
                        
                        <div class="auto-bet-status" id="auto-bet-status">
                            Ready to place random bets automatically
                        </div>
                    </div>
                </div>
                
                <!-- PLACE GAME BUTTON -->
                <div class="place-game-btn-container">
                    <button class="place-game-btn" id="place-game-btn" onclick="placeBet()">
                        <i class="fas fa-play-circle"></i> PLACE GAME
                    </button>
                </div>
                
                <div class="game-status" id="game-status" style="text-align: center; margin-top: 20px; padding: 10px; border-radius: 10px;">
                    <!-- Status messages -->
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <p style="color: #666; font-size: 14px;">
                        üéØ <strong>Game Rule:</strong> Lowest unique number wins!<br>
                        No duplicate numbers allowed. Format: X.XXX (e.g., 0.001, 1.111, 123.456)
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- CASH IN MODAL -->
    <div id="cashin-modal" class="modal hidden">
        <div class="modal-content">
            <h3 style="color: #667eea; text-align: center;">üí∞ Cash In</h3>
            <p style="text-align: center; margin-bottom: 20px;">Select amount to deposit (expires in 5 days):</p>
            
            <div class="cashin-options">
                <button class="cashin-option" onclick="selectAmount(50)">‚Ç±50.000</button>
                <button class="cashin-option" onclick="selectAmount(100)">‚Ç±100.000</button>
                <button class="cashin-option" onclick="selectAmount(250)">‚Ç±250.000</button>
                <button class="cashin-option" onclick="selectAmount(500)">‚Ç±500.000</button>
                <button class="cashin-option" onclick="selectAmount(750)">‚Ç±750.000</button>
                <button class="cashin-option" onclick="selectAmount(1000)">‚Ç±1000.000</button>
            </div>
            
            <div class="selected-amount" style="text-align: center; margin: 30px 0; padding: 20px; background: #f0f8ff; border-radius: 10px;">
                <h4>Selected Amount</h4>
                <div style="font-size: 48px; font-weight: bold; color: #28a745;" id="selected-amount" class="decimal-format">0.000</div>
                <p style="margin-top: 10px;">‚è∞ Expires: <span id="expiry-date">--/--/----</span></p>
                <p class="service-fee">No service fee for deposits</p>
            </div>
            
            <button onclick="confirmCashIn()" class="btn-primary" style="margin-bottom: 10px;">
                <i class="fas fa-check-circle"></i> Confirm Cash In
            </button>
            <button onclick="closeModal()" class="btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </div>
    
    <!-- ADD ITEM MODAL (ADMIN) -->
    <div id="add-item-modal" class="modal hidden">
        <div class="modal-content">
            <h3 style="color: #667eea; text-align: center;">‚ûï Add Raffle Item</h3>
            
            <div style="display: grid; gap: 15px; margin: 20px 0;">
                <input type="text" id="item-name-input" placeholder="Item Name (e.g., iPhone 15)" style="padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                
                <input type="number" id="item-price" placeholder="Price Value (‚Ç±)" style="padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                
                <input type="text" id="item-image-url" placeholder="Image URL" style="padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                
                <!-- START RAFFLE DATE & TIME -->
                <div>
                    <label class="form-label">Start Raffle Date & Time:</label>
                    <input type="datetime-local" id="start-date" class="datetime-input">
                </div>
                
                <!-- END RAFFLE DATE & TIME -->
                <div>
                    <label class="form-label">End Raffle Date & Time:</label>
                    <input type="datetime-local" id="end-date" class="datetime-input">
                </div>
                
                <!-- RAFFLE DAY DATE & TIME -->
                <div>
                    <label class="form-label">Raffle Day Date & Time:</label>
                    <input type="datetime-local" id="raffle-date" class="datetime-input">
                </div>
                
                <!-- WINNER DATE & TIME -->
                <div>
                    <label class="form-label">Winner Announcement Date & Time:</label>
                    <input type="datetime-local" id="winner-date" class="datetime-input">
                </div>
            </div>
            
            <button onclick="addNewItem()" class="btn-primary" style="margin-bottom: 10px;">
                <i class="fas fa-plus"></i> Add Item
            </button>
            <button onclick="closeModal()" class="btn-secondary">
                Cancel
            </button>
        </div>
    </div>
    
    <!-- WALLET SETUP MODAL -->
    <div id="wallet-modal" class="modal hidden">
        <div class="modal-content">
            <h3 style="color: #667eea; text-align: center;">üè¶ Setup E-Wallets</h3>
            
            <div style="margin: 20px 0;">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Shopee Wallet Number:</label>
                    <input type="text" id="shopee-input" placeholder="09XXXXXXXXX" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 25px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Lazada Wallet Number:</label>
                    <input type="text" id="lazada-input" placeholder="09XXXXXXXXX" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px;">
                </div>
                
                <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                    <p style="margin: 0; font-size: 14px; color: #666;">
                        <i class="fas fa-info-circle"></i> $2.00 service fee applies when transferring expired balances
                    </p>
                </div>
            </div>
            
            <button onclick="saveWalletInfo()" class="btn-primary" style="margin-bottom: 10px;">
                Save Wallet Information
            </button>
            <button onclick="closeModal()" class="btn-secondary">
                Cancel
            </button>
        </div>
    </div>
    
    <!-- TRANSFER MODAL -->
    <div id="transfer-modal" class="modal hidden">
        <div class="modal-content">
            <h3 style="color: #667eea; text-align: center;">üí∏ Transfer Expired Balance</h3>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 36px; font-weight: bold; color: #28a745; margin: 15px 0;" id="transfer-amount" class="decimal-format">‚Ç±0.000</div>
                <p>Expired deposit needs to be transferred</p>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #856404; margin-bottom: 10px;">Service Fee Information</h4>
                <p style="margin: 5px 0;"><strong>$2.00 service fee</strong> will be deducted</p>
                <p style="margin: 5px 0;">Net amount after fee: <strong id="net-amount" class="decimal-format">‚Ç±0.000</strong></p>
            </div>
            
            <div style="margin: 25px 0;">
                <p style="text-align: center; font-weight: bold; margin-bottom: 15px;">Choose transfer method:</p>
                
                <div class="transfer-buttons">
                    <button class="transfer-btn shopee-btn" onclick="transferToShopee()">
                        <i class="fas fa-shopping-cart"></i> Shopee Wallet
                    </button>
                    <button class="transfer-btn lazada-btn" onclick="transferToLazada()">
                        <i class="fas fa-truck"></i> Lazada Wallet
                    </button>
                </div>
            </div>
            
            <button onclick="closeModal()" class="btn-secondary">
                Cancel
            </button>
        </div>
    </div>

    <!-- NOTIFICATION AREA -->
    <div id="notification-area" style="position: fixed; top: 20px; right: 20px; z-index: 1001;"></div>

    <!-- JAVASCRIPT -->
    <script>
        // ================ GLOBAL VARIABLES ================
        let currentUser = null;
        let currentItem = null;
        let selectedAmount = 0;
        let betNumber = '0.000';
        let betAmount = 50.000;
        let currentDepositId = null;
        let serviceFee = 2.00;
        let refundFeePercent = 2;
        let randomNumbers = [];
        let randomCount = 1;
        let isAutoBetting = false;
        let autoBetInterval = null;
        
        // ================ INITIAL DATA ================
        function initializeData() {
            if (!localStorage.getItem('raffle_users')) {
                const demoUsers = {};
                for (let i = 1; i <= 5; i++) {
                    demoUsers[i] = {
                        username: i.toString(),
                        password: i.toString(),
                        balance: 50.000,
                        deposits: [],
                        walletInfo: { shopee: '', lazada: '' },
                        bets: [],
                        serviceFees: 0.000
                    };
                }
                demoUsers['admin'] = {
                    username: 'admin',
                    password: 'admin123',
                    balance: 0.000,
                    deposits: [],
                    walletInfo: { shopee: '', lazada: '' },
                    bets: [],
                    isAdmin: true,
                    serviceFees: 0.000
                };
                localStorage.setItem('raffle_users', JSON.stringify(demoUsers));
            }
            
            if (!localStorage.getItem('raffle_items')) {
                const demoItems = [
                    {
                        id: 1,
                        name: "iPhone 15 Pro",
                        description: "Brand new iPhone 15 Pro 256GB",
                        image: "https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=400&h=300&fit=crop",
                        price: 69999.000,
                        category: "electronics",
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
                        raffleDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
                        winnerDate: new Date(Date.now() + 8 * 24 * 60 * 60 * 1000).toISOString(),
                        status: "active",
                        bets: [],
                        serviceFeesCollected: 0.000
                    },
                    {
                        id: 2,
                        name: "Samsung Galaxy S23",
                        description: "Latest Samsung flagship phone",
                        image: "https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w=400&h=300&fit=crop",
                        price: 45999.000,
                        category: "electronics",
                        startDate: new Date().toISOString(),
                        endDate: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString(),
                        raffleDate: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString(),
                        winnerDate: new Date(Date.now() + 6 * 24 * 60 * 60 * 1000).toISOString(),
                        status: "active",
                        bets: [],
                        serviceFeesCollected: 0.000
                    }
                ];
                localStorage.setItem('raffle_items', JSON.stringify(demoItems));
            }
            
            if (!localStorage.getItem('raffle_bets')) {
                localStorage.setItem('raffle_bets', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('system_fees')) {
                localStorage.setItem('system_fees', JSON.stringify({
                    totalServiceFees: 0.000,
                    totalRefundFees: 0.000
                }));
            }
        }
        
        // ================ FORMAT FUNCTIONS ================
        function formatDecimal(value, decimals = 3) {
            return parseFloat(value).toFixed(decimals);
        }
        
        function formatCurrency(value) {
            return `‚Ç±${formatDecimal(value)}`;
        }
        
        function formatUSD(value) {
            return `$${formatDecimal(value, 2)}`;
        }
        
        // ================ LOGIN FUNCTIONS ================
        function fillLogin(username, password) {
            document.getElementById('username').value = username;
            document.getElementById('password').value = password;
        }
        
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                showNotification('Please enter username and password', 'error');
                return;
            }
            
            initializeData();
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            
            if (users[username] && users[username].password === password) {
                currentUser = username;
                
                if (users[username].isAdmin) {
                    showAdminDashboard();
                } else {
                    showUserDashboard();
                    checkDepositExpirations();
                }
                
                showNotification('Login successful!', 'success');
            } else {
                showNotification('Invalid username or password', 'error');
            }
        }
        
        function adminLogin() {
            document.getElementById('username').value = 'admin';
            document.getElementById('password').value = 'admin123';
            login();
        }
        
        // ================ DASHBOARD FUNCTIONS ================
        function showUserDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('user-dashboard').classList.remove('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            
            loadUserData();
            loadRaffleItems();
        }
        
        function showAdminDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('user-dashboard').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.remove('hidden');
            
            loadAdminData();
        }
        
        function logout() {
            currentUser = null;
            currentItem = null;
            
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('user-dashboard').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            
            document.getElementById('username').value = '';
            document.getElementById('password').value = '1';
            
            showNotification('Logged out successfully', 'success');
        }
        
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            if (tabName === 'wallet') {
                loadDeposits();
            } else if (tabName === 'bets') {
                loadUserBets();
            }
        }
        
        // ================ USER DATA FUNCTIONS ================
        function loadUserData() {
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            const user = users[currentUser];
            
            if (!user) return;
            
            document.getElementById('current-user').textContent = currentUser;
            document.getElementById('user-balance').textContent = formatDecimal(user.balance);
            document.getElementById('wallet-balance').textContent = formatDecimal(user.balance);
            document.getElementById('modal-balance').textContent = formatDecimal(user.balance);
            
            document.getElementById('shopee-wallet').textContent = 
                user.walletInfo.shopee || 'Not set';
            document.getElementById('lazada-wallet').textContent = 
                user.walletInfo.lazada || 'Not set';
        }
        
        // ================ GAME MODAL FUNCTIONS ================
        function openGameModal(itemId) {
            const items = JSON.parse(localStorage.getItem('raffle_items'));
            currentItem = items.find(item => item.id === itemId);
            
            if (!currentItem) return;
            
            const now = new Date();
            const endDate = new Date(currentItem.endDate);
            
            if (now > endDate) {
                showNotification('This raffle has ended', 'error');
                return;
            }
            
            document.getElementById('item-name').textContent = currentItem.name;
            document.getElementById('item-image').src = currentItem.image;
            
            // Reset betting state
            betNumber = '0.000';
            betAmount = 50.000;
            randomNumbers = [];
            randomCount = 1;
            
            document.getElementById('bet-number').value = betNumber;
            document.getElementById('current-bet-amount').textContent = formatDecimal(betAmount);
            document.getElementById('bet-slider').value = betAmount;
            
            // Reset random numbers display
            document.getElementById('random-numbers-display').innerHTML = '';
            
            // Reset button controls
            document.querySelectorAll('.bet-control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.bet-control-btn')[0].classList.add('active');
            
            // Reset auto betting
            stopAutoBet();
            
            // Update balance display
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            const user = users[currentUser];
            document.getElementById('modal-balance').textContent = formatDecimal(user.balance);
            updateAfterBet();
            
            document.getElementById('game-modal').classList.remove('hidden');
        }
        
        function addNumber(num) {
            let currentNum = betNumber.replace(/\./g, '');
            
            if (num === '.') {
                if (betNumber.includes('.')) {
                    showNotification('Decimal point already added', 'warning');
                    return;
                }
                currentNum = '0' + currentNum;
                if (currentNum.length > 4) {
                    currentNum = currentNum.slice(0, 4);
                }
                betNumber = currentNum.slice(0, 1) + '.' + currentNum.slice(1, 4).padEnd(3, '0');
            } else {
                currentNum += num;
                if (currentNum.length > 4) {
                    currentNum = currentNum.slice(1, 5);
                }
                
                if (currentNum.length <= 1) {
                    betNumber = '0.' + currentNum.padEnd(3, '0');
                } else {
                    betNumber = currentNum.slice(0, 1) + '.' + currentNum.slice(1, 4).padEnd(3, '0');
                }
            }
            
            document.getElementById('bet-number').value = betNumber;
        }
        
        function clearNumber() {
            betNumber = '0.000';
            document.getElementById('bet-number').value = betNumber;
        }
        
        function setBetAmount(amount) {
            betAmount = parseFloat(amount);
            document.getElementById('current-bet-amount').textContent = formatDecimal(betAmount);
            document.getElementById('bet-slider').value = betAmount;
            updateAfterBet();
        }
        
        document.getElementById('bet-slider').addEventListener('input', function() {
            betAmount = parseFloat(this.value);
            document.getElementById('current-bet-amount').textContent = formatDecimal(betAmount);
            updateAfterBet();
        });
        
        function updateAfterBet() {
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            const user = users[currentUser];
            const afterBet = parseFloat(user.balance) - betAmount;
            document.getElementById('after-bet').textContent = formatDecimal(afterBet);
            
            const feeWarning = document.getElementById('fee-warning');
            const placeGameBtn = document.getElementById('place-game-btn');
            
            if (afterBet < 0) {
                document.getElementById('after-bet').style.color = '#f44336';
                feeWarning.textContent = 'Insufficient balance! Please deposit more.';
                placeGameBtn.disabled = true;
                placeGameBtn.style.opacity = '0.6';
                placeGameBtn.innerHTML = '<i class="fas fa-exclamation-circle"></i> INSUFFICIENT BALANCE';
            } else {
                document.getElementById('after-bet').style.color = '#333';
                feeWarning.textContent = '';
                placeGameBtn.disabled = false;
                placeGameBtn.style.opacity = '1';
                placeGameBtn.innerHTML = '<i class="fas fa-play-circle"></i> PLACE GAME';
            }
        }
        
        function placeBet() {
            const numValue = parseFloat(betNumber);
            if (isNaN(numValue) || numValue < 0) {
                showNotification('Please enter a valid number', 'error');
                return;
            }
            
            const decimalPart = betNumber.split('.')[1];
            if (!decimalPart || decimalPart.length !== 3) {
                showNotification('Number must have exactly 3 decimal places (e.g., 0.123)', 'error');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            const user = users[currentUser];
            
            if (parseFloat(user.balance) < betAmount) {
                showNotification('Insufficient balance! Please cash in.', 'error');
                return;
            }
            
            const bets = JSON.parse(localStorage.getItem('raffle_bets')) || [];
            const existingBet = bets.find(bet => 
                bet.itemId === currentItem.id && bet.number === numValue
            );
            
            if (existingBet) {
                showNotification('This number is already taken! Choose another.', 'error');
                return;
            }
            
            // Animate button
            const placeGameBtn = document.getElementById('place-game-btn');
            placeGameBtn.classList.add('placed');
            placeGameBtn.innerHTML = '<i class="fas fa-check-circle"></i> BET PLACED!';
            
            const newBet = {
                id: Date.now(),
                userId: currentUser,
                itemId: currentItem.id,
                number: numValue,
                amount: betAmount,
                placedAt: new Date().toISOString(),
                status: 'active'
            };
            
            bets.push(newBet);
            localStorage.setItem('raffle_bets', JSON.stringify(bets));
            
            // Deduct bet amount from user balance (NOT the bet number!)
            user.balance = formatDecimal(parseFloat(user.balance) - betAmount);
            user.bets = user.bets || [];
            user.bets.push(newBet.id);
            users[currentUser] = user;
            localStorage.setItem('raffle_users', JSON.stringify(users));
            
            // Add bet to item
            const items = JSON.parse(localStorage.getItem('raffle_items'));
            const itemIndex = items.findIndex(item => item.id === currentItem.id);
            items[itemIndex].bets = items[itemIndex].bets || [];
            items[itemIndex].bets.push(newBet.id);
            localStorage.setItem('raffle_items', JSON.stringify(items));
            
            // Show success message
            const statusDiv = document.getElementById('game-status');
            statusDiv.innerHTML = `
                <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 10px;">
                    <h4><i class="fas fa-check-circle"></i> Bet Placed Successfully!</h4>
                    <p>Number: <strong>${betNumber}</strong></p>
                    <p>Bet Amount: <strong class="decimal-format">‚Ç±${formatDecimal(betAmount)}</strong></p>
                    <p>Remaining Balance: <strong class="decimal-format">‚Ç±${formatDecimal(user.balance)}</strong></p>
                </div>
            `;
            
            // Update UI
            loadUserData();
            updateAfterBet();
            
            // Reset button after 2 seconds
            setTimeout(() => {
                placeGameBtn.classList.remove('placed');
                placeGameBtn.innerHTML = '<i class="fas fa-play-circle"></i> PLACE GAME';
                
                // Clear bet number for next bet
                betNumber = '0.000';
                document.getElementById('bet-number').value = betNumber;
                
                // Clear status after 3 seconds
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 3000);
            }, 2000);
        }
        
        // ================ RANDOM BET FUNCTIONS ================
        function generateRandomNumber() {
            // Generate random number between 0 and 999.999
            const wholePart = Math.floor(Math.random() * 1000);
            const decimalPart = Math.floor(Math.random() * 1000);
            const randomNum = parseFloat(`${wholePart}.${decimalPart.toString().padStart(3, '0')}`);
            
            betNumber = randomNum.toFixed(3);
            document.getElementById('bet-number').value = betNumber;
            
            // Add to random numbers list
            if (randomNumbers.length >= 20) {
                randomNumbers.shift();
            }
            randomNumbers.push(betNumber);
            
            // Update display
            updateRandomNumbersDisplay();
        }
        
        function setRandomCount(count) {
            randomCount = count;
            
            // Update button states
            document.querySelectorAll('.bet-control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Generate multiple random numbers
            randomNumbers = [];
            for (let i = 0; i < count; i++) {
                const wholePart = Math.floor(Math.random() * 1000);
                const decimalPart = Math.floor(Math.random() * 1000);
                const randomNum = parseFloat(`${wholePart}.${decimalPart.toString().padStart(3, '0')}`);
                randomNumbers.push(randomNum.toFixed(3));
            }
            
            // Set first number as current bet
            if (randomNumbers.length > 0) {
                betNumber = randomNumbers[0];
                document.getElementById('bet-number').value = betNumber;
            }
            
            updateRandomNumbersDisplay();
        }
        
        function updateRandomNumbersDisplay() {
            const display = document.getElementById('random-numbers-display');
            display.innerHTML = '';
            
            randomNumbers.forEach((num, index) => {
                const badge = document.createElement('div');
                badge.className = 'random-number-badge';
                badge.textContent = num;
                badge.style.cursor = 'pointer';
                badge.onclick = () => {
                    betNumber = num;
                    document.getElementById('bet-number').value = betNumber;
                };
                display.appendChild(badge);
            });
        }
        
        function useMaxBalance() {
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            const user = users[currentUser];
            const balance = parseFloat(user.balance);
            
            if (balance <= 0) {
                showNotification('No balance available', 'error');
                return;
            }
            
            // Calculate maximum bets we can place
            const maxBets = Math.floor(balance / betAmount);
            
            if (maxBets <= 0) {
                showNotification(`Insufficient balance for ‚Ç±${formatDecimal(betAmount)} bet`, 'error');
                return;
            }
            
            // Generate random numbers for all bets
            randomNumbers = [];
            const betsToPlace = Math.min(maxBets, 50); // Limit to 50 bets max
            
            for (let i = 0; i < betsToPlace; i++) {
                const wholePart = Math.floor(Math.random() * 1000);
                const decimalPart = Math.floor(Math.random() * 1000);
                const randomNum = parseFloat(`${wholePart}.${decimalPart.toString().padStart(3, '0')}`);
                randomNumbers.push(randomNum.toFixed(3));
            }
            
            // Update display
            updateRandomNumbersDisplay();
            
            showNotification(`Generated ${betsToPlace} random numbers. Click "Place Game" to bet them all.`, 'info');
        }
        
        function toggleAutoBet() {
            const autoBetBtn = document.getElementById('auto-bet-btn');
            const autoBetStatus = document.getElementById('auto-bet-status');
            
            if (!isAutoBetting) {
                // Start auto betting
                const users = JSON.parse(localStorage.getItem('raffle_users'));
                const user = users[currentUser];
                const balance = parseFloat(user.balance);
                
                if (balance < betAmount) {
                    showNotification('Insufficient balance for auto betting', 'error');
                    return;
                }
                
                isAutoBetting = true;
                autoBetBtn.innerHTML = '<i class="fas fa-stop"></i> Stop Auto Betting';
                autoBetBtn.style.background = '#dc3545';
                autoBetStatus.innerHTML = `<span style="color: #28a745;"><i class="fas fa-spinner fa-spin"></i> Auto betting in progress...</span>`;
                
                // Start auto betting interval
                autoBetInterval = setInterval(() => {
                    const users = JSON.parse(localStorage.getItem('raffle_users'));
                    const user = users[currentUser];
                    const balance = parseFloat(user.balance);
                    
                    if (balance < betAmount) {
                        stopAutoBet();
                        showNotification('Auto betting stopped: Insufficient balance', 'warning');
                        return;
                    }
                    
                    // Generate random number
                    const wholePart = Math.floor(Math.random() * 1000);
                    const decimalPart = Math.floor(Math.random() * 1000);
                    betNumber = parseFloat(`${wholePart}.${decimalPart.toString().padStart(3, '0')}`).toFixed(3);
                    
                    // Place the bet
                    placeSingleBet(betNumber);
                    
                }, 2000); // Place bet every 2 seconds
                
            } else {
                // Stop auto betting
                stopAutoBet();
            }
        }
        
        function stopAutoBet() {
            isAutoBetting = false;
            const autoBetBtn = document.getElementById('auto-bet-btn');
            const autoBetStatus = document.getElementById('auto-bet-status');
            
            autoBetBtn.innerHTML = '<i class="fas fa-play"></i> Start Auto Betting';
            autoBetBtn.style.background = '#fd7e14';
            autoBetStatus.innerHTML = 'Ready to place random bets automatically';
            
            if (autoBetInterval) {
                clearInterval(autoBetInterval);
                autoBetInterval = null;
            }
        }
        
        function placeSingleBet(number) {
            const numValue = parseFloat(number);
            
            const users = JSON.parse(localStorage.getItem('raffle_users'));
            const user = users[currentUser];
            
            if (parseFloat(user.balance) < betAmount) {
                return false;
            }
            
            const bets = JSON.parse(localStorage.getItem('raffle_bets')) || [];
            const existingBet = bets.find(bet => 
                bet.itemId === currentItem.id && bet.number === numValue
            );
            
            if (existingBet) {
                return false; // Number already taken
            }
            
            const newBet = {
                id: Date.now(),
                userId: currentUser,
                itemId: currentItem.id,
                number: numValue,
                amount: betAmount,
                placedAt: new Date().toISOString(),
                status: 'active'
            };
            
            bets.push(newBet);
            localStorage.setItem('raffle_bets', JSON.stringify(bets));
            
            // Deduct bet amount
            user.balance = formatDecimal(parseFloat(user.balance) - betAmount);
            user.bets = user.bets || [];
            user.bets.push(newBet.id);
            users[currentUser] = user;
            localStorage.setItem('raffle_users', JSON.stringify(users));
            
            // Add to item
            const items = JSON.parse(localStorage.getItem('raffle_items'));
            const itemIndex = items.findIndex(item => item.id === currentItem.id);
            items[itemIndex].bets = items[itemIndex].bets || [];
            items[itemIndex].bets.push(newBet.id);
            localStorage.setItem('raffle_items', JSON.stringify(items));
            
            // Update UI
            loadUserData();
            updateAfterBet();
            
            return true;
        }
        
        // ================ OTHER FUNCTIONS (keep existing) ================
        // [Keep all the existing functions from the previous code for:
        // loadDeposits(), checkDepositExpirations(), showTransferModal(),
        // transferToShopee(), transferToLazada(), showCashIn(), selectAmount(),
        // confirmCashIn(), sendMoney(), loadAdminData(), checkExpirations(),
        // showAddItem(), addNewItem(), runItemRaffle(), runRaffle(),
        // deleteItem(), resetAllData(), showWalletSetup(), saveWalletInfo(),
        // loadUserBets(), closeModal(), showNotification(), initializeData()]
        // These functions remain exactly as they were in the previous code
        
        // ================ INITIALIZATION ================
        window.onload = function() {
            initializeData();
            showNotification('Welcome to Raffle Game Prototype! Use username 1-5 with same password.', 'info');
        };
    </script>
</body>
</html>
